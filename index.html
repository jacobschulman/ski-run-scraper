<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ski Run Scraper - Daily Grooming & Snow Reports</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <h1>üéø Ski Run Scraper</h1>
    <p class="subtitle">Daily grooming, lift status, and snow report data for 39 ski resorts. Each resort scraped at 7 AM local time during its operating season.</p>

    <div class="info-section">
        <h3>‚ÑπÔ∏è How It Works</h3>
        <ul>
            <li><strong>Automatic Updates:</strong> GitHub Actions workflow runs every 3 hours and scrapes each resort once daily at 7 AM in the resort's local timezone</li>
            <li><strong>Smart Scheduling:</strong> Resorts are only scraped during their expected operating season (dates configured per resort)</li>
            <li><strong>Historical Data:</strong> All data is archived with daily timestamps and retained indefinitely</li>
            <li><strong>Dual Format:</strong> Data available as human-readable web pages AND a JSON API for developers</li>
        </ul>
    </div>

    <div id="resorts-container">
        <div class="loading">Loading resorts...</div>
    </div>

    <div class="info-section">
        <h3>üì° For Developers</h3>
        <p>Access the raw data via our JSON API, perfect for building your own apps, integrations, or IoT projects.</p>
        <div class="links">
            <a href="data/index.html" class="link-button">API Documentation</a>
            <a href="https://github.com/jacobschulman/ski-run-scraper" class="link-button">GitHub Repository</a>
        </div>
    </div>

    <script>
        // Region mappings
        const regions = {
            'Colorado': ['vail', 'beavercreek', 'breckenridge', 'keystone', 'crestedbutte'],
            'California/Nevada': ['heavenly', 'northstar', 'kirkwood'],
            'Pacific Northwest': ['stevenspass'],
            'Vermont': ['stowe', 'okemo', 'mountsnow'],
            'New York': ['hunter'],
            'New Hampshire': ['attitash', 'wildcat', 'mountsunapee', 'crotched'],
            'Pennsylvania': ['liberty', 'roundtop', 'whitetail', 'jackfrost', 'bigboulder', 'hiddenvalleypa', 'laurelmountain', 'sevensprings'],
            'Midwest': ['wilmot', 'aftonalps', 'mtbrighton', 'alpinevalley', 'bostonmills', 'brandywine', 'madrivermountain', 'hiddenvalley', 'snowcreek', 'paolipeaks'],
            'Utah': ['parkcity'],
            'Canada': ['whistlerblackcomb'],
            'Australia': ['perisher', 'fallscreek', 'hotham']
        };

        // Fetch and display resorts
        fetch('config.json')
            .then(response => response.json())
            .then(config => {
                const resorts = config.resorts;
                const container = document.getElementById('resorts-container');
                container.innerHTML = '';

                // Group resorts by region
                for (const [region, resortKeys] of Object.entries(regions)) {
                    const regionResorts = resorts.filter(r => resortKeys.includes(r.key));
                    if (regionResorts.length === 0) continue;

                    const section = document.createElement('div');
                    section.className = 'region-section';

                    const heading = document.createElement('h2');
                    heading.textContent = region;
                    section.appendChild(heading);

                    const grid = document.createElement('div');
                    grid.className = 'resort-grid';

                    regionResorts.forEach(resort => {
                        const card = document.createElement('div');
                        card.className = 'resort-card';

                        const name = document.createElement('h4');
                        name.textContent = resort.name;
                        card.appendChild(name);

                        const links = document.createElement('div');
                        links.className = 'resort-links';

                        // Grooming link (all resorts have terrain data)
                        const groomingLink = document.createElement('a');
                        groomingLink.href = `data/${resort.key}/grooming.html`;
                        groomingLink.className = 'resort-link';
                        groomingLink.textContent = '‚õ∑Ô∏è Grooming';
                        links.appendChild(groomingLink);

                        // Snow report link (if available)
                        if (resort.snowReportUrl) {
                            const snowLink = document.createElement('a');
                            snowLink.href = `data/${resort.key}/snow.html`;
                            snowLink.className = 'resort-link snow';
                            snowLink.textContent = '‚ùÑÔ∏è Snow';
                            links.appendChild(snowLink);
                        }

                        card.appendChild(links);
                        grid.appendChild(card);
                    });

                    section.appendChild(grid);
                    container.appendChild(section);
                }
            })
            .catch(error => {
                console.error('Error loading resorts:', error);
                document.getElementById('resorts-container').innerHTML =
                    '<div class="loading">Error loading resorts. Please try again later.</div>';
            });
    </script>
</body>
</html>
